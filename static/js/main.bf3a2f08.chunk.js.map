{"version":3,"sources":["constants.js","utils.js","SettingsPane.js","diagrams.js","logic.js","MainView.js","customHooks.js","Version.js","App.js","reportWebVitals.js","index.js","worker.js"],"names":["MAX_RUNS","MAX_STEPS","range","n","Array","from","keys","randomChoice","xs","Math","floor","random","length","argmax","topValue","Number","NEGATIVE_INFINITY","ties","forEach","value","index","push","average","reduce","acc","x","clamp","min","max","SettingsPane","settings","onOk","onCancel","useState","webWorkers","U","k","runs","C","steps","values","setValues","onChangeValue","propertyName","e","valueNumber","target","isInteger","formRef","useRef","Form","noValidate","validated","onSubmit","preventDefault","current","checkValidity","ref","Group","Label","size","Control","as","custom","onChange","map","required","type","Feedback","className","variant","onClick","drawDiagram","chartElement","lines","yAxisOptions","maybeTicks","undefined","ticks","Chart","data","datasets","line","label","fill","borderColor","colour","borderWidth","radius","options","legend","labels","boxWidth","scales","xAxes","scaleLabel","display","labelString","_","autoSkip","maxRotation","callback","tick","yAxes","events","animation","duration","GreedyActionSelector","_actions","_ns","qs","_t","EpsilonGreedyActionSelector","epsilon","this","actions","UCBActionSelector","c","ns","t","ucb","q","MAX_VALUE","sqrt","log","constantStepSizeCalculator","stepSize","_n","decayingStepSizeCalculator","Experiment","actionSelector","stepSizeCalculator","initialValue","action","reward","oldEstimate","newEstimate","name","makeExperiment","experimentConfig","actionSelectorName","args","Error","makeActionSelector","stepSizeCalculatorName","makeStepSizeCalculator","averageAcrossWorkers","workerResults","experimentIndex","numSteps","step","wr","pluckValueFromStep","pluckValuesFromSteps","drawDiagrams","experiments","results","lines1","experiment","averageRewardsPerStep","D","lines2","averagePercentOptimalActionsPerStep","MainView","setSettings","experimentsConfig","L","workerResultsRef","runsCompletedCount","setRunsCompletedCount","workersCompletedCount","setWorkersCompletedCount","running","setRunning","useEffect","finalResults","firstWorkerResult","firstExperiment","numExperiments","averageRewards","combineWorkerResults","onMessageCallbackWrapper","cb","cbRef","useCallbackWrapper","message","count","workerInstances","worker","workerInstance","addEventListener","run","useCallback","normalWorkerRuns","lastWorkerRuns","lastWorkerIndex","workerIndex","workerRuns","workerMessage","runExperiments","settingsPaneIsOpen","setSettingsPaneIsOpen","closeSettingsPane","ProgressBar","now","disabled","id","title","width","isOpen","onRequestClose","Version","version","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","addMethods","methods","module","exports","w","Worker"],"mappings":"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","file":"static/js/main.bf3a2f08.chunk.js","sourcesContent":["export const MIN_WEB_WORKERS = 1\nexport const MAX_WEB_WORKERS = 8\nexport const INITIAL_WEB_WORKERS = 4\n\nexport const MIN_K = 2\nexport const MAX_K = 10\nexport const INITIAL_K = MAX_K\n\nexport const MIN_RUNS = 10\nexport const MAX_RUNS = 1e6\nexport const INITIAL_RUNS = 2000\n\nexport const MIN_STEPS = 10\nexport const MAX_STEPS = 1e6\nexport const INITIAL_STEPS = 1000\n","export const range = n => Array.from(Array(n).keys())\n\nexport const randomChoice = xs => xs[Math.floor(Math.random() * xs.length)]\n\nexport const argmax = xs => {\n  let topValue = Number.NEGATIVE_INFINITY\n  let ties = []\n  xs.forEach((value, index) => {\n    if (value > topValue) {\n      topValue = value\n      ties = [index]\n    } else {\n      if (value === topValue) {\n        ties.push(index)\n      }\n    }\n  })\n  return ties.length === 1 ? ties[0] : randomChoice(ties)\n}\n\nexport const average = xs => {\n  const sum = xs.reduce((acc, x) => acc + x, 0)\n  const count = xs.length\n  return sum / count\n}\n\nexport const clamp = (min, max, value) =>\n  Math.min(Math.max(value, min), max)\n","import React, { useRef, useState } from 'react'\nimport { Form } from 'react-bootstrap'\nimport * as C from './constants'\nimport * as U from './utils'\nimport './SettingsPane.css'\n\nconst SettingsPane = ({ settings, onOk, onCancel }) => {\n\n  const [values, setValues] = useState({\n    webWorkers: U.clamp(C.MIN_WEB_WORKERS, C.MAX_WEB_WORKERS, settings.webWorkers),\n    k: U.clamp(C.MIN_K, C.MAX_K, settings.k),\n    runs: U.clamp(C.MIN_RUNS, C.MAX_RUNS, settings.runs),\n    steps: U.clamp(C.MIN_STEPS, C.MAX_STEPS, settings.steps)\n  })\n\n  const onChangeValue = propertyName => e => {\n    const valueNumber = Number(e.target.value)\n    const value = Number.isInteger(valueNumber) && valueNumber > 0 ? valueNumber : ''\n    setValues(values => ({ ...values, [propertyName]: value }))\n  }\n\n  const onSubmit = e => {\n    e.preventDefault()\n    if (formRef.current && formRef.current.checkValidity()) {\n      onOk(values)\n    }\n  }\n\n  const formRef = useRef()\n\n  return (\n    <Form noValidate validated={true} onSubmit={onSubmit} ref={formRef}>\n      <Form.Group>\n        <Form.Label size=\"sm\">Web Workers</Form.Label>\n        <Form.Control as=\"select\" custom size=\"sm\" value={values.webWorkers} onChange={onChangeValue('webWorkers')}>\n          {U.range(C.MAX_WEB_WORKERS).map((n => n + 1)).map(n => <option key={n} value={n}>{n}</option>)}\n        </Form.Control>\n      </Form.Group>\n\n      <Form.Group>\n        <Form.Label size=\"sm\">Arms (k)</Form.Label>\n        <Form.Control as=\"select\" custom size=\"sm\" value={values.k} onChange={onChangeValue('k')}>\n          {U.range(C.MAX_K - C.MIN_K + 1).map((n => n + C.MIN_K)).map(n => <option key={n} value={n}>{n}</option>)}\n        </Form.Control>\n      </Form.Group>\n\n      <Form.Group>\n        <Form.Label size=\"sm\">Runs</Form.Label>\n        <Form.Control\n          size=\"sm\"\n          required\n          type=\"number\"\n          min={C.MIN_RUNS}\n          max={C.MAX_RUNS}\n          value={values.runs}\n          onChange={onChangeValue('runs')}\n        />\n        <Form.Control.Feedback type=\"invalid\">\n          Must be a number between {C.MIN_RUNS} and {C.MAX_RUNS}\n        </Form.Control.Feedback>\n      </Form.Group>\n\n      <Form.Group>\n        <Form.Label size=\"sm\">Steps</Form.Label>\n        <Form.Control\n          size=\"sm\"\n          required\n          type=\"number\"\n          min={C.MIN_STEPS}\n          max={C.MAX_STEPS}\n          value={values.steps}\n          onChange={onChangeValue('steps')}\n        />\n        <Form.Control.Feedback type=\"invalid\">\n          Must be a number between {C.MIN_STEPS} and {C.MAX_STEPS}\n        </Form.Control.Feedback>\n      </Form.Group>\n\n      <div className=\"basic-config__controls\">\n        <button variant=\"primary\" type=\"submit\">OK</button>\n        <button type=\"button\" onClick={onCancel}>Cancel</button>\n      </div>\n    </Form>\n  )\n}\n\nexport default SettingsPane\n","import { Chart } from 'chart.js'\n\nexport const drawDiagram = (chartElement, lines, yAxisOptions) => {\n\n  const makeDataset = line => ({\n    data: line.data,\n    label: line.label,\n    fill: false,\n    borderColor: line.colour,\n    borderWidth: 1,\n    radius: 0\n  })\n\n  const maybeTicks = yAxisOptions.min !== undefined && yAxisOptions.max !== undefined\n    ? {\n      ticks: {\n        min: yAxisOptions.min,\n        max: yAxisOptions.max\n      }\n    }\n    : undefined\n\n  new Chart(chartElement, {\n    type: 'line',\n    data: {\n      datasets: lines.map(makeDataset)\n    },\n    options: {\n      legend: {\n        labels: {\n          boxWidth: 20\n        }\n      },\n      scales: {\n        xAxes: [{\n          scaleLabel: {\n            display: true,\n            labelString: 'Steps'\n          },\n          labels: lines[0].data.map((_, index) => index + 1),\n          ticks: {\n            autoSkip: false,\n            maxRotation: 0,\n            callback: tick => {\n              if (tick === 1) return 1\n              return tick % 250 === 0 ? tick : null\n            }\n          }\n        }],\n        yAxes: [{\n          scaleLabel: {\n            display: true,\n            labelString: yAxisOptions.label\n          },\n          ...maybeTicks\n        }]\n      },\n      events: [],\n      animation: {\n        duration: 0\n      }\n    }\n  })\n}\n","import random from 'random'\nimport * as U from './utils'\n\nexport class GreedyActionSelector {\n  get name() {\n    return 'greedy'\n  }\n\n  selectAction(_actions, _ns, qs, _t) {\n    return U.argmax(qs)\n  }\n}\n\nexport class EpsilonGreedyActionSelector {\n  constructor(epsilon) {\n    this.epsilon = epsilon\n  }\n\n  get name() {\n    return `ε-greedy, ε = ${this.epsilon}`\n  }\n\n  selectAction(actions, _ns, qs, _t) {\n    return Math.random() < this.epsilon\n      ? U.randomChoice(actions)\n      : U.argmax(qs)\n  }\n}\n\nexport class UCBActionSelector {\n  constructor(c) {\n    this.c = c\n  }\n\n  get name() {\n    return `UCB, c = ${this.c}`\n  }\n\n  selectAction(_actions, ns, qs, t) {\n    return U.argmax(this.ucb(ns, qs, t))\n  }\n\n  ucb(ns, qs, t) {\n    return qs.map((q, index) => {\n      const n = ns[index]\n      if (n === 0) return Number.MAX_VALUE\n      return q + this.c * Math.sqrt(Math.log(t) / n)\n    })\n  }\n}\n\nexport const constantStepSizeCalculator = stepSize => _n => stepSize\nexport const decayingStepSizeCalculator = n => 1 / n\n\nexport class Experiment {\n  constructor(actions, actionSelector, stepSizeCalculator, colour, initialValue = 0) {\n    this.actions = actions\n    this.actionSelector = actionSelector\n    this.stepSizeCalculator = stepSizeCalculator\n    this.colour = colour\n    this.initialValue = initialValue\n    this.ns = []\n    this.qs = []\n  }\n\n  get name() {\n    return this.actionSelector.name\n  }\n\n  reset() {\n    this.ns = Array(this.actions.length).fill(0)\n    this.qs = Array(this.actions.length).fill(this.initialValue)\n  }\n\n  update(action, reward) {\n    const n = this.ns[action] + 1\n    this.ns[action] = n\n    const oldEstimate = this.qs[action]\n    const alpha = this.stepSizeCalculator(n)\n    const newEstimate = oldEstimate + alpha * (reward - oldEstimate)\n    this.qs[action] = newEstimate\n  }\n}\n\nexport class ExperimentResults {\n  constructor(steps) {\n    this.steps = steps\n    this.reset()\n  }\n\n  reset() {\n    this.runningAverageReward = Array(this.steps).fill(0)\n    this.runningAveragePercentOptimalAction = Array(this.steps).fill(0)\n  }\n\n  update(step, n, reward, isOptimal) {\n    this.updateRunningAverageReward(step, n, reward)\n    this.updateRunningAveragePercentOptimalAction(step, n, isOptimal)\n  }\n\n  updateRunningAverageReward(step, n, reward,) {\n    const oldAverage = this.runningAverageReward[step]\n    const newAverage = oldAverage + (1 / n) * (reward - oldAverage)\n    this.runningAverageReward[step] = newAverage\n  }\n\n  updateRunningAveragePercentOptimalAction(step, n, isOptimal,) {\n    const percentOptimalAction = isOptimal ? 100 : 0\n    const oldAverage = this.runningAveragePercentOptimalAction[step]\n    const newAverage = oldAverage + (1 / n) * (percentOptimalAction - oldAverage)\n    this.runningAveragePercentOptimalAction[step] = newAverage\n  }\n}\n\nexport class TestBed {\n  constructor(k) {\n    this.armDistributions = TestBed.makeArmDistributions(k)\n    const trueValues = this.armDistributions.map(({ trueValue }) => trueValue)\n    this.optimalArm = U.argmax(trueValues)\n  }\n\n  static makeArmDistributions(k) {\n    const trueValues = TestBed.makeTrueValues(k)\n    const armDistributions = trueValues.map((trueValue, arm) => {\n      const mean = trueValue\n      const variance = 1\n      const normal = random.normal(mean, variance)\n      return { arm, trueValue, normal }\n    })\n    return armDistributions\n  }\n\n  static makeTrueValues(k) {\n    const mean = 0\n    const variance = 1\n    const normal = random.normal(mean, variance)\n    const trueValues = U.range(k).map(normal)\n    return trueValues\n  }\n}\n\nexport const bandit = (testBed, experiment, t) => {\n  const arm = experiment.actionSelector.selectAction(\n    experiment.actions,\n    experiment.ns,\n    experiment.qs,\n    t)\n  const reward = testBed.armDistributions[arm].normal()\n  experiment.update(arm, reward)\n  const isOptimal = arm === testBed.optimalArm\n  return { reward, isOptimal }\n}\n\nexport const makeActionSelector = experimentConfig => {\n  const [actionSelectorName, ...args] = experimentConfig.actionSelector\n  switch (actionSelectorName) {\n    case 'GreedyActionSelector': return new GreedyActionSelector(...args)\n    case 'EpsilonGreedyActionSelector': return new EpsilonGreedyActionSelector(...args)\n    case 'UCBActionSelector': return new UCBActionSelector(...args)\n    default: throw new Error(`Unexpected actionSelectorName, \"${actionSelectorName}\"`)\n  }\n}\n\nexport const makeStepSizeCalculator = experimentConfig => {\n  const [stepSizeCalculatorName, ...args] = experimentConfig.stepSizeCalculator\n  switch (stepSizeCalculatorName) {\n    case 'decayingStepSizeCalculator': return decayingStepSizeCalculator\n    case 'constantStepSizeCalculator': return constantStepSizeCalculator(...args)\n    default: throw new Error(`Unexpected stepSizeCalculatorName, \"${stepSizeCalculatorName}\"`)\n  }\n}\n\nexport const makeExperiment = (experimentConfig, actions) =>\n  new Experiment(\n    actions,\n    makeActionSelector(experimentConfig),\n    makeStepSizeCalculator(experimentConfig),\n    experimentConfig.colour,\n    experimentConfig.initialValue)\n","import React, { useCallback, useEffect, useRef, useState } from 'react'\nimport { ProgressBar } from 'react-bootstrap'\nimport SlidingPane from 'react-sliding-pane'\nimport { useCallbackWrapper } from './customHooks'\nimport SettingsPane from './SettingsPane'\nimport * as C from './constants'\nimport * as D from './diagrams'\nimport * as L from './logic'\nimport * as U from './utils'\nimport { AiOutlineSetting } from 'react-icons/ai'\nimport './MainView.css'\nimport 'react-sliding-pane/dist/react-sliding-pane.css'\n\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport worker from 'workerize-loader!./worker'\n\n// --------------------------------------------------------------------------------\n\nconst pluckValueFromStep = (propertyName, workerResults, experimentIndex, step) =>\n  workerResults.map(wr => wr[experimentIndex][propertyName][step])\n\nconst pluckValuesFromSteps = (propertyName, workerResults, experimentIndex, numSteps) =>\n  U.range(numSteps).map(step =>\n    pluckValueFromStep(propertyName, workerResults, experimentIndex, step))\n\nconst averageAcrossWorkers = (propertyName, workerResults, experimentIndex, numSteps) => {\n  const workerValuesPerStep = pluckValuesFromSteps(propertyName, workerResults, experimentIndex, numSteps)\n  // step   0: [w0, w1, w2, w3]\n  // step   1: [w0, w1, w2, w3]\n  // ...\n  // step 999: [w0, w1, w2, w3]\n  return workerValuesPerStep.map(U.average)\n}\n\n// wr0: [exp0, exp1, exp2, exp4]\n// wr1: [exp0, exp1, exp2, exp4]\n// wr2: [exp0, exp1, exp2, exp4]\n// wr3: [exp0, exp1, exp2, exp4]\n// where:\n// exp0: { averageRewardsPerStep: [v0, v1, ...v999], averagePercentOptimalActions: [v0, v1, ...v999]}\n// exp1: { averageRewardsPerStep: [v0, v1, ...v999], averagePercentOptimalActions: [v0, v1, ...v999]}\n// exp2: { averageRewardsPerStep: [v0, v1, ...v999], averagePercentOptimalActions: [v0, v1, ...v999]}\n// exp3: { averageRewardsPerStep: [v0, v1, ...v999], averagePercentOptimalActions: [v0, v1, ...v999]}\nconst combineWorkerResults = workerResults => {\n\n  const firstWorkerResult = workerResults[0]\n  const firstExperiment = firstWorkerResult[0]\n\n  const numExperiments = firstWorkerResult.length\n  const numSteps = firstExperiment.averageRewards.length\n\n  const finalResults = U.range(numExperiments).map(experimentIndex => ({\n    averageRewardsPerStep: averageAcrossWorkers(\n      'averageRewards',\n      workerResults,\n      experimentIndex,\n      numSteps),\n    averagePercentOptimalActionsPerStep: averageAcrossWorkers(\n      'averagePercentOptimalActions',\n      workerResults,\n      experimentIndex,\n      numSteps)\n  }))\n  return finalResults\n}\n\n// --------------------------------------------------------------------------------\n\nconst drawDiagrams = (experiments, results) => {\n\n  const lines1 = experiments.map((experiment, experimentIndex) => ({\n    label: experiment.name,\n    colour: experiment.colour,\n    data: results[experimentIndex].averageRewardsPerStep\n  }))\n  D.drawDiagram('chart1', lines1, {\n    label: 'Average reward'\n  })\n\n  const lines2 = experiments.map((experiment, experimentIndex) => ({\n    label: experiment.name,\n    colour: experiment.colour,\n    data: results[experimentIndex].averagePercentOptimalActionsPerStep\n  }))\n  D.drawDiagram('chart2', lines2, {\n    label: '% Optimal action',\n    min: 0,\n    max: 100\n  })\n}\n\n// --------------------------------------------------------------------------------\n\nconst MainView = () => {\n\n  const [settings, setSettings] = useState({\n    webWorkers: C.INITIAL_WEB_WORKERS,\n    k: C.INITIAL_K,\n    runs: C.INITIAL_RUNS,\n    steps: C.INITIAL_STEPS\n  })\n\n  const [experimentsConfig] = useState(() => [\n    {\n      actionSelector: ['GreedyActionSelector'],\n      stepSizeCalculator: ['decayingStepSizeCalculator'],\n      colour: 'green'\n    },\n    {\n      actionSelector: ['EpsilonGreedyActionSelector', 0.01],\n      stepSizeCalculator: ['decayingStepSizeCalculator'],\n      colour: 'red'\n    },\n    {\n      actionSelector: ['EpsilonGreedyActionSelector', 0.1],\n      stepSizeCalculator: ['decayingStepSizeCalculator'],\n      colour: 'blue'\n    },\n    {\n      actionSelector: ['UCBActionSelector', 2],\n      stepSizeCalculator: ['decayingStepSizeCalculator'],\n      colour: 'purple'\n    }\n  ])\n\n  // We only create 'experiments' here because we want to read 'name' and\n  // 'colour' later inside 'drawDiagrams'. Ideally, find a way to get rid.\n  // Ideally, we'd pass 'experimentsConfig' instead of 'experiments' to 'drawDiagrams'.\n  const [experiments] = useState(() =>\n    experimentsConfig.map(experimentConfig =>\n      L.makeExperiment(experimentConfig, U.range(settings.k))))\n\n  const workerResultsRef = useRef([])\n\n  const [runsCompletedCount, setRunsCompletedCount] = useState(0)\n  const [workersCompletedCount, setWorkersCompletedCount] = useState(0)\n  const [running, setRunning] = useState(false)\n\n  const onMessage = message => {\n    switch (message.data.type) {\n\n      case 'runExperimentsRunCompleted':\n        setRunsCompletedCount(count => count + 1)\n        break\n\n      case 'runExperimentsResults':\n        setWorkersCompletedCount(count => count + 1)\n        workerResultsRef.current.push(message.data.results)\n        break\n\n      case 'RPC':\n      default:\n        return\n    }\n  }\n\n  useEffect(() => {\n    if (runsCompletedCount === settings.runs && workersCompletedCount === settings.webWorkers) {\n      const finalResults = combineWorkerResults(workerResultsRef.current)\n      drawDiagrams(experiments, finalResults)\n      setRunning(false)\n    }\n  }, [settings, experiments, runsCompletedCount, workersCompletedCount])\n\n  const onMessageCallbackWrapper = useCallbackWrapper(onMessage)\n\n  const [workerInstances] = useState(() => {\n    const workerInstances = U.range(C.MAX_WEB_WORKERS).map(worker)\n    workerInstances.forEach(workerInstance =>\n      workerInstance.addEventListener('message', onMessageCallbackWrapper))\n    return workerInstances\n  })\n\n  const run = useCallback(() => {\n    setRunning(true)\n    setRunsCompletedCount(0)\n    setWorkersCompletedCount(0)\n    workerResultsRef.current = []\n\n    const normalWorkerRuns = Math.floor(settings.runs / settings.webWorkers)\n    const lastWorkerRuns = settings.runs - (settings.webWorkers - 1) * normalWorkerRuns\n\n    const lastWorkerIndex = settings.webWorkers - 1\n\n    U.range(settings.webWorkers).forEach(workerIndex => {\n      const workerInstance = workerInstances[workerIndex]\n      const workerRuns = workerIndex === lastWorkerIndex ? lastWorkerRuns : normalWorkerRuns\n      const workerMessage = {\n        k: settings.k,\n        runs: workerRuns,\n        steps: settings.steps,\n        experimentsConfig\n      }\n      workerInstance.runExperiments(workerMessage, workerIndex)\n    })\n\n    drawDiagrams(experiments, experiments.map(() => ({\n      averageRewardsPerStep: [],\n      averagePercentOptimalActionsPerStep: []\n    })))\n  }, [settings, experimentsConfig, experiments, workerInstances])\n\n  useEffect(run, [run])\n\n  const onRun = () => run()\n\n  const [settingsPaneIsOpen, setSettingsPaneIsOpen] = useState(false)\n\n  const openSettingsPane = () => {\n    setSettingsPaneIsOpen(true)\n  }\n\n  const closeSettingsPane = () => {\n    setSettingsPaneIsOpen(false)\n  }\n\n  const onSettingsPaneOk = values => {\n    setSettings(values)\n    closeSettingsPane()\n  }\n\n  const onSettingsPaneCancel = () => {\n    closeSettingsPane()\n  }\n\n  return (\n    <div className=\"mainview-layout\">\n      <div className=\"controls\">\n        <span>Runs completed:</span>\n        <ProgressBar min={0} max={settings.runs} now={runsCompletedCount} />\n        <button onClick={onRun} disabled={running}>Run</button>\n        <button onClick={openSettingsPane} disabled={running}>\n          <AiOutlineSetting />\n        </button>\n      </div>\n      <div className=\"chart-wrapper\">\n        <canvas id=\"chart1\"></canvas>\n      </div>\n      <div className=\"chart-wrapper\">\n        <canvas id=\"chart2\"></canvas>\n      </div>\n      <SlidingPane\n        from=\"left\"\n        title=\"Settings\"\n        width=\"300px\"\n        isOpen={settingsPaneIsOpen}\n        onRequestClose={closeSettingsPane}\n      >\n        <SettingsPane\n          settings={settings}\n          onOk={onSettingsPaneOk}\n          onCancel={onSettingsPaneCancel}\n        />\n      </SlidingPane>\n    </div>\n  )\n}\n\nexport default MainView\n","import { useRef } from 'react'\n\nexport const useCallbackWrapper = cb => {\n  const cbRef = useRef(null)\n  cbRef.current = cb\n  const cbWrapper = (...args) => {\n    if (cbRef.current) {\n      return cbRef.current(...args)\n    }\n  }\n  return cbWrapper\n}\n","import { version } from '../package.json'\nimport './Version.css'\n\nconst Version = () =>\n  <div className=\"version\">version: {version}</div>\n\nexport default Version\n","import MainView from './MainView'\nimport Version from './Version'\nimport './App.css'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <MainView />\n      <Version />\n    </div>\n  )\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry)\n      getFID(onPerfEntry)\n      getFCP(onPerfEntry)\n      getLCP(onPerfEntry)\n      getTTFB(onPerfEntry)\n    })\n  }\n}\n\nexport default reportWebVitals\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport './index.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n","\n\t\t\t\tvar addMethods = require(\"../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"runExperiments\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"f05ae514683ada4abe14.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t"],"sourceRoot":""}