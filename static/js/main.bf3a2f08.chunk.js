(this["webpackJsonpk-armed-bandit"]=this["webpackJsonpk-armed-bandit"]||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n.n(a),i=n(30),s=n.n(i),o=n(8),u=n(104),l=n(37),b=n.n(l),j=n(21),d=n(16),f=n(103),p=1e6,h=1e6,m=function(e){return Array.from(Array(e).keys())},O=function(e){return e[Math.floor(Math.random()*e.length)]},v=function(e){var t=Number.NEGATIVE_INFINITY,n=[];return e.forEach((function(e,r){e>t?(t=e,n=[r]):e===t&&n.push(r)})),1===n.length?n[0]:O(n)},x=function(e){return e.reduce((function(e,t){return e+t}),0)/e.length},S=function(e,t,n){return Math.min(Math.max(n,e),t)},k=(n(59),function(e){var t=e.settings,n=e.onOk,c=e.onCancel,i=Object(a.useState)({webWorkers:S(1,8,t.webWorkers),k:S(2,10,t.k),runs:S(10,p,t.runs),steps:S(10,h,t.steps)}),s=Object(o.a)(i,2),u=s[0],l=s[1],b=function(e){return function(t){var n=Number(t.target.value),r=Number.isInteger(n)&&n>0?n:"";l((function(t){return Object(d.a)(Object(d.a)({},t),{},Object(j.a)({},e,r))}))}},O=Object(a.useRef)();return Object(r.jsxs)(f.a,{noValidate:!0,validated:!0,onSubmit:function(e){e.preventDefault(),O.current&&O.current.checkValidity()&&n(u)},ref:O,children:[Object(r.jsxs)(f.a.Group,{children:[Object(r.jsx)(f.a.Label,{size:"sm",children:"Web Workers"}),Object(r.jsx)(f.a.Control,{as:"select",custom:!0,size:"sm",value:u.webWorkers,onChange:b("webWorkers"),children:m(8).map((function(e){return e+1})).map((function(e){return Object(r.jsx)("option",{value:e,children:e},e)}))})]}),Object(r.jsxs)(f.a.Group,{children:[Object(r.jsx)(f.a.Label,{size:"sm",children:"Arms (k)"}),Object(r.jsx)(f.a.Control,{as:"select",custom:!0,size:"sm",value:u.k,onChange:b("k"),children:m(9).map((function(e){return e+2})).map((function(e){return Object(r.jsx)("option",{value:e,children:e},e)}))})]}),Object(r.jsxs)(f.a.Group,{children:[Object(r.jsx)(f.a.Label,{size:"sm",children:"Runs"}),Object(r.jsx)(f.a.Control,{size:"sm",required:!0,type:"number",min:10,max:p,value:u.runs,onChange:b("runs")}),Object(r.jsxs)(f.a.Control.Feedback,{type:"invalid",children:["Must be a number between ",10," and ",p]})]}),Object(r.jsxs)(f.a.Group,{children:[Object(r.jsx)(f.a.Label,{size:"sm",children:"Steps"}),Object(r.jsx)(f.a.Control,{size:"sm",required:!0,type:"number",min:10,max:h,value:u.steps,onChange:b("steps")}),Object(r.jsxs)(f.a.Control.Feedback,{type:"invalid",children:["Must be a number between ",10," and ",h]})]}),Object(r.jsxs)("div",{className:"basic-config__controls",children:[Object(r.jsx)("button",{variant:"primary",type:"submit",children:"OK"}),Object(r.jsx)("button",{type:"button",onClick:c,children:"Cancel"})]})]})}),g=n(38),y=function(e,t,n){var r=void 0!==n.min&&void 0!==n.max?{ticks:{min:n.min,max:n.max}}:void 0;new g.Chart(e,{type:"line",data:{datasets:t.map((function(e){return{data:e.data,label:e.label,fill:!1,borderColor:e.colour,borderWidth:1,radius:0}}))},options:{legend:{labels:{boxWidth:20}},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Steps"},labels:t[0].data.map((function(e,t){return t+1})),ticks:{autoSkip:!1,maxRotation:0,callback:function(e){return 1===e?1:e%250===0?e:null}}}],yAxes:[Object(d.a)({scaleLabel:{display:!0,labelString:n.label}},r)]},events:[],animation:{duration:0}}})},C=n(23),w=n(17),A=n(31),z=n(11),E=n(12),N=(n(32),function(){function e(){Object(z.a)(this,e)}return Object(E.a)(e,[{key:"selectAction",value:function(e,t,n,r){return v(n)}},{key:"name",get:function(){return"greedy"}}]),e}()),R=function(){function e(t){Object(z.a)(this,e),this.epsilon=t}return Object(E.a)(e,[{key:"selectAction",value:function(e,t,n,r){return Math.random()<this.epsilon?O(e):v(n)}},{key:"name",get:function(){return"\u03b5-greedy, \u03b5 = ".concat(this.epsilon)}}]),e}(),W=function(){function e(t){Object(z.a)(this,e),this.c=t}return Object(E.a)(e,[{key:"selectAction",value:function(e,t,n,r){return v(this.ucb(t,n,r))}},{key:"ucb",value:function(e,t,n){var r=this;return t.map((function(t,a){var c=e[a];return 0===c?Number.MAX_VALUE:t+r.c*Math.sqrt(Math.log(n)/c)}))}},{key:"name",get:function(){return"UCB, c = ".concat(this.c)}}]),e}(),P=function(e){return function(t){return e}},M=function(e){return 1/e},G=function(){function e(t,n,r,a){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Object(z.a)(this,e),this.actions=t,this.actionSelector=n,this.stepSizeCalculator=r,this.colour=a,this.initialValue=c,this.ns=[],this.qs=[]}return Object(E.a)(e,[{key:"reset",value:function(){this.ns=Array(this.actions.length).fill(0),this.qs=Array(this.actions.length).fill(this.initialValue)}},{key:"update",value:function(e,t){var n=this.ns[e]+1;this.ns[e]=n;var r=this.qs[e],a=r+this.stepSizeCalculator(n)*(t-r);this.qs[e]=a}},{key:"name",get:function(){return this.actionSelector.name}}]),e}(),L=function(e,t){return new G(t,function(e){var t=Object(A.a)(e.actionSelector),n=t[0],r=t.slice(1);switch(n){case"GreedyActionSelector":return Object(C.a)(N,Object(w.a)(r));case"EpsilonGreedyActionSelector":return Object(C.a)(R,Object(w.a)(r));case"UCBActionSelector":return Object(C.a)(W,Object(w.a)(r));default:throw new Error('Unexpected actionSelectorName, "'.concat(n,'"'))}}(e),function(e){var t=Object(A.a)(e.stepSizeCalculator),n=t[0],r=t.slice(1);switch(n){case"decayingStepSizeCalculator":return M;case"constantStepSizeCalculator":return P.apply(void 0,Object(w.a)(r));default:throw new Error('Unexpected stepSizeCalculatorName, "'.concat(n,'"'))}}(e),e.colour,e.initialValue)},q=n(41),F=(n(95),n(96),n(39)),I=n.n(F),V=function(e,t,n,r){return function(e,t,n,r){return m(r).map((function(r){return function(e,t,n,r){return t.map((function(t){return t[n][e][r]}))}(e,t,n,r)}))}(e,t,n,r).map(x)},U=function(e,t){var n=e.map((function(e,n){return{label:e.name,colour:e.colour,data:t[n].averageRewardsPerStep}}));y("chart1",n,{label:"Average reward"});var r=e.map((function(e,n){return{label:e.name,colour:e.colour,data:t[n].averagePercentOptimalActionsPerStep}}));y("chart2",r,{label:"% Optimal action",min:0,max:100})},B=function(){var e=Object(a.useState)({webWorkers:4,k:10,runs:2e3,steps:1e3}),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)((function(){return[{actionSelector:["GreedyActionSelector"],stepSizeCalculator:["decayingStepSizeCalculator"],colour:"green"},{actionSelector:["EpsilonGreedyActionSelector",.01],stepSizeCalculator:["decayingStepSizeCalculator"],colour:"red"},{actionSelector:["EpsilonGreedyActionSelector",.1],stepSizeCalculator:["decayingStepSizeCalculator"],colour:"blue"},{actionSelector:["UCBActionSelector",2],stepSizeCalculator:["decayingStepSizeCalculator"],colour:"purple"}]})),s=Object(o.a)(i,1)[0],l=Object(a.useState)((function(){return s.map((function(e){return L(e,m(n.k))}))})),j=Object(o.a)(l,1)[0],d=Object(a.useRef)([]),f=Object(a.useState)(0),p=Object(o.a)(f,2),h=p[0],O=p[1],v=Object(a.useState)(0),x=Object(o.a)(v,2),S=x[0],g=x[1],y=Object(a.useState)(!1),C=Object(o.a)(y,2),w=C[0],A=C[1];Object(a.useEffect)((function(){if(h===n.runs&&S===n.webWorkers){var e=function(e){var t=e[0],n=t[0],r=t.length,a=n.averageRewards.length;return m(r).map((function(t){return{averageRewardsPerStep:V("averageRewards",e,t,a),averagePercentOptimalActionsPerStep:V("averagePercentOptimalActions",e,t,a)}}))}(d.current);U(j,e),A(!1)}}),[n,j,h,S]);var z=function(e){var t=Object(a.useRef)(null);return t.current=e,function(){if(t.current)return t.current.apply(t,arguments)}}((function(e){switch(e.data.type){case"runExperimentsRunCompleted":O((function(e){return e+1}));break;case"runExperimentsResults":g((function(e){return e+1})),d.current.push(e.data.results);break;case"RPC":default:return}})),E=Object(a.useState)((function(){var e=m(8).map(I.a);return e.forEach((function(e){return e.addEventListener("message",z)})),e})),N=Object(o.a)(E,1)[0],R=Object(a.useCallback)((function(){A(!0),O(0),g(0),d.current=[];var e=Math.floor(n.runs/n.webWorkers),t=n.runs-(n.webWorkers-1)*e,r=n.webWorkers-1;m(n.webWorkers).forEach((function(a){var c=N[a],i=a===r?t:e,o={k:n.k,runs:i,steps:n.steps,experimentsConfig:s};c.runExperiments(o,a)})),U(j,j.map((function(){return{averageRewardsPerStep:[],averagePercentOptimalActionsPerStep:[]}})))}),[n,s,j,N]);Object(a.useEffect)(R,[R]);var W=Object(a.useState)(!1),P=Object(o.a)(W,2),M=P[0],G=P[1],F=function(){G(!1)};return Object(r.jsxs)("div",{className:"mainview-layout",children:[Object(r.jsxs)("div",{className:"controls",children:[Object(r.jsx)("span",{children:"Runs completed:"}),Object(r.jsx)(u.a,{min:0,max:n.runs,now:h}),Object(r.jsx)("button",{onClick:function(){return R()},disabled:w,children:"Run"}),Object(r.jsx)("button",{onClick:function(){G(!0)},disabled:w,children:Object(r.jsx)(q.a,{})})]}),Object(r.jsx)("div",{className:"chart-wrapper",children:Object(r.jsx)("canvas",{id:"chart1"})}),Object(r.jsx)("div",{className:"chart-wrapper",children:Object(r.jsx)("canvas",{id:"chart2"})}),Object(r.jsx)(b.a,{from:"left",title:"Settings",width:"300px",isOpen:M,onRequestClose:F,children:Object(r.jsx)(k,{settings:n,onOk:function(e){c(e),F()},onCancel:function(){F()}})})]})},T=n(40),_=(n(98),function(){return Object(r.jsxs)("div",{className:"version",children:["version: ",T.a]})});n(99);var J=function(){return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(B,{}),Object(r.jsx)(_,{})]})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,105)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};n(100),n(101);s.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(J,{})}),document.getElementById("root")),D()},39:function(e,t,n){var r=n(97),a=["runExperiments"];e.exports=function(){var e=new Worker(n.p+"f05ae514683ada4abe14.worker.js",{name:"[hash].worker.js"});return r(e,a),e}},40:function(e){e.exports=JSON.parse('{"a":"0.0.11"}')},59:function(e,t,n){},80:function(e,t){},95:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[102,1,2]]]);
//# sourceMappingURL=main.bf3a2f08.chunk.js.map